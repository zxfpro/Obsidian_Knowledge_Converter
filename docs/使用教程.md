# Obsidian 知识转换工具使用教程

## 1. 工具简介

本工具旨在将特定格式的 JSON 数据转换为 Obsidian 兼容的 Markdown 文件。它能够处理文件夹和文件的层级结构，并自动重写内部链接，以便在 Obsidian 中正确显示。

## 2. 安装

本工具是一个 Python 项目。在运行之前，请确保您已安装 Python 环境。

1.  **克隆仓库** (如果尚未克隆):
    ```bash
    git clone https://github.com/your-repo/Obsidian_Knowledge_Converter.git
    cd Obsidian_Knowledge_Converter
    ```
    *(请将 `https://github.com/your-repo/Obsidian_Knowledge_Converter.git` 替换为实际的仓库地址)*

2.  **安装依赖**:
    ```bash
    pip install -e .
    ```
    或者，如果您使用 `uv` (一个更快的 Python 包管理器):
    ```bash
    uv pip install -e .
    ```

## 3. 使用方法

本工具通过运行 `main.py` 脚本来执行转换。您需要提供一个符合特定 JSON 格式的输入数据。

### 3.1 输入数据格式

输入数据是一个 JSON 对象，它描述了您希望转换的知识库结构。主要包含以下字段：

*   `name`: 文件夹或文件的名称。
*   `type`: 类型，可以是 `"folder"` (文件夹) 或 `"file"` (文件)。
*   `children`: (可选) 如果是文件夹，包含其子文件夹和文件的列表。
*   `content`: (仅限文件类型) 包含文件内容的详细信息，包括：
    *   `title`: 文件或章节的标题。
    *   `level`: 标题级别 (例如，1 代表 H1)。
    *   `content`: 实际的 Markdown 内容。**注意：对于 `level=1` 的内容，其前 100 个字符将用于生成 Markdown 文件的 `describe` Frontmatter 字段。**
    *   `children`: (可选) 如果文件包含子章节，则为子章节的列表。

### 3.2 运行转换

1.  **准备输入 JSON 数据**:
    您可以直接修改 `main.py` 中的 `input_json_data` 变量，或者从外部文件加载 JSON 数据。

2.  **执行脚本**:
    在项目根目录下运行 `main.py` 脚本：
    ```bash
    python main.py
    ```

### 3.3 输出文件结构与 YAML Frontmatter

转换后的 Markdown 文件将生成在 `output_vault` 目录下 (此目录会在转换过程中自动创建)。

**核心变更：**

*   **文件作为目录页：** 转换后的主文件和所有子文件（由原始文件内部 H2+ 标题拆分生成）将作为“目录”或“导航页”。它们的正文内容将不再包含原始的文本内容，而是仅包含一个指向其所有直接子标题（已拆分为独立文件）的 Obsidian 双链列表。
*   **移除子文件中的父级链接：** 子文件将不再包含指向其原始父文件或父章节的显式链接，以简化内容。

**YAML Frontmatter：**

所有生成的 Markdown 文件顶部都将包含标准的 YAML Frontmatter，以 `---` 包裹，提供丰富的元数据：

*   `title`: 文件的主标题。
*   `describe`: 提取自当前文件对应原始内容的前 100 个字符，作为文件内容的简要描述。
*   `aliases`: 包含原始标题的 slugified 版本，以及其他可能的别名，便于搜索和引用。
*   **预留字段：** `type`, `ends`, `version`, `over`, `tags` (目前为空，为未来扩展预留)。

这些元数据增强了 Obsidian 文件的管理能力，便于搜索、过滤和组织知识库。

## 4. 示例

以下是 `main.py` 中使用的示例 JSON 数据，它将生成一个名为 `optimizing` 的文件夹，其中包含 `advanced_retrieval` 文件夹，并在其中生成两个 Markdown 文件 (`advanced_retrieval.md` 和 `query_transformations.md`)。

```json
{
    "name": "optimizing",
    "type": "folder",
    "children": [
        {
            "name": "advanced_retrieval",
            "type": "folder",
            "children": [
                {
                    "name": "advanced_retrieval.md",
                    "type": "file",
                    "content": {
                        "title": "Advanced Retrieval Strategies",
                        "level": 1,
                        "content": "Some top-level content for adv_retrieval.md. See [Query Transformations Docs](../../optimizing/advanced_retrieval/query_transformations.md).",
                        "children": [
                            {
                                "title": "Query Transformations",
                                "level": 2,
                                "content": "Info about query transformations. This is a sub-section.",
                                "children": []
                            }
                        ]
                    }
                },
                {
                    "name": "query_transformations.md",
                    "type": "file",
                    "content": {
                        "title": "Query Transformations",
                        "level": 1,
                        "content": "This is a separate file about query transformations.",
                        "children": []
                    }
                }
            ]
        }
    ]
}
```

运行 `python main.py` 后，您将在 `output_vault` 目录下找到相应的 Markdown 文件。